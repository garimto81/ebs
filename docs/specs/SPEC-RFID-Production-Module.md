# EBS 프로덕션 RFID 모듈 스펙 정의서

**Version**: 1.0.0
**Date**: 2026-01-30
**Status**: Draft
**Author**: EBS Project Team

---

## 1. Executive Summary

> **"EBS에서 정식으로 사용할 최종 사양 RFID 모듈"의 명확한 정의**

본 문서는 Stage-Pre에서 확정하는 **프로덕션 RFID 모듈 요구사항**을 정의합니다.
"RFID 통신 성공"이란 본 문서에 정의된 스펙을 충족하는 모듈에서의 성공을 의미합니다.

---

## 2. 최종 사양 정의

### 2.1 핵심 선언

> **EBS 프로덕션 RFID 모듈 = "자체 정의 프로덕션 스펙"을 충족하는 모듈**

| 항목 | 정의 |
|------|------|
| **최종 사양** | 본 문서(SPEC-RFID-Production-Module.md)의 요구사항 충족 |
| **검증 기준** | 모든 P0 요구사항 PASS |
| **확정 시점** | Stage 0 Gate 통과 시 |

### 2.2 PokerGFX 벤치마크

PokerGFX Security Whitepaper 기준 핵심 스펙:

| 항목 | PokerGFX 스펙 | EBS 목표 |
|------|--------------|----------|
| RFID 주파수 | 13.56MHz HF | **동일** |
| 프로토콜 | ISO 14443 (추정) | **동일** |
| 카드 DB 암호화 | AES-256 | **동일** |
| USB 통신 암호화 | TLS 1.2 | TLS 1.2+ |
| 안테나 구성 | 다중 (플레이어별) | 다중 (Stage 1+) |
| Reader Module | 중앙 집중형 | 분산형 (Stage 0) → 중앙형 (Stage 1+) |

---

## 3. 기능적 요구사항 (Functional Requirements)

### 3.1 P0 - 필수 (Stage 0 Gate 조건)

| ID | 요구사항 | 수용 기준 | 검증 방법 |
|:--:|----------|----------|----------|
| FR-01 | **13.56MHz HF 주파수** | ISO 14443A 지원 | 데이터시트 확인 |
| FR-02 | **MIFARE Classic 호환** | 1K/4K 카드 인식 | 테스트 카드 인식 |
| FR-03 | **UID 읽기** | 4/7-byte UID 정확 추출 | 10회 연속 일치 |
| FR-04 | **읽기 거리 3cm+** | 카드 3cm 거리에서 100% 인식 | 100회 테스트 |
| FR-05 | **응답 시간 < 100ms** | 카드 감지 → UID 출력 | 타임스탬프 측정 |
| FR-06 | **ESP32 SPI 호환** | 3.3V 직접 연결 | 배선 + 통신 |
| FR-07 | **연속 운영 4시간+** | 장애 없이 동작 | 스트레스 테스트 |

### 3.2 P1 - 권장 (Stage 1 목표)

| ID | 요구사항 | 수용 기준 | 검증 방법 |
|:--:|----------|----------|----------|
| FR-08 | 읽기 거리 5cm+ | 5cm 거리에서 95%+ 인식 | 100회 테스트 |
| FR-09 | 다중 카드 감지 | 2장 동시 인식 | 중첩 테스트 |
| FR-10 | 충돌 방지 | Anti-collision 지원 | ISO 14443-3 |
| FR-11 | 다중 리더 연결 | 6+ 리더 동시 운영 | 스케일 테스트 |

### 3.3 P2 - 선택 (Stage 2+ 목표)

| ID | 요구사항 | 수용 기준 |
|:--:|----------|----------|
| FR-12 | MIFARE DESFire 지원 | ISO 14443-4 |
| FR-13 | NFC 태그 지원 | NTAG 213/215 |
| FR-14 | 읽기 거리 7cm+ | 산업용 수준 |

---

## 4. 비기능적 요구사항 (Non-Functional Requirements)

### 4.1 보안 (Security)

| ID | 요구사항 | 수용 기준 | Stage |
|:--:|----------|----------|:-----:|
| NFR-S01 | 카드 DB AES-256 암호화 | SW 레이어 구현 | 1 |
| NFR-S02 | USB 통신 TLS 1.2+ | ESP32-S3 + mbedTLS | 1+ |
| NFR-S03 | Secure Delay 지원 | 그래픽 딜레이 분리 | 1 |
| NFR-S04 | Trustless Mode 지원 | 실시간 카드 정보 비노출 | 1 |

### 4.2 안정성 (Reliability)

| ID | 요구사항 | 수용 기준 | Stage |
|:--:|----------|----------|:-----:|
| NFR-R01 | 인식 성공률 99%+ | 1000회 중 990+ 성공 | 0 |
| NFR-R02 | 8시간 연속 운영 | 장애 없음 | 1 |
| NFR-R03 | 자동 재연결 | 연결 끊김 시 5초 내 복구 | 1 |
| NFR-R04 | 핫 스왑 지원 | 리더 교체 시 재시작 불필요 | 2 |

### 4.3 성능 (Performance)

| ID | 요구사항 | 수용 기준 | Stage |
|:--:|----------|----------|:-----:|
| NFR-P01 | E2E 지연 < 200ms | 카드 → 화면 | 0 |
| NFR-P02 | E2E 지연 < 100ms | 최적화 후 | 1 |
| NFR-P03 | CPU 사용률 < 30% | ESP32 기준 | 0 |

### 4.4 확장성 (Scalability)

| ID | 요구사항 | 수용 기준 | Stage |
|:--:|----------|----------|:-----:|
| NFR-E01 | 다중 안테나 지원 | 1 리더 → 6+ 안테나 | 1+ |
| NFR-E02 | 다중 테이블 지원 | 4+ 테이블 동시 운영 | 2 |
| NFR-E03 | 중앙 집중 관리 | Reader Module 아키텍처 | 2 |

---

## 5. 모듈 후보 평가

### 5.1 평가 매트릭스

| 요구사항 | MFRC522 | ST25R3911B | PN532 정품 | 평가 기준 |
|----------|:-------:|:----------:|:----------:|----------|
| **FR-01** 13.56MHz | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-02** MIFARE | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-03** UID 읽기 | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-04** 3cm+ 거리 | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-05** <100ms | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-06** ESP32 SPI | ✅ | ✅ | ✅ | 모두 충족 |
| **FR-07** 4시간 운영 | ⚠️ | ✅ | ✅ | MFRC522 클론 불안정 |
| **FR-08** 5cm+ 거리 | ❌ | ✅ | ⚠️ | MFRC522 3-5cm 한계 |
| **FR-11** 다중 리더 | ⚠️ | ✅ | ✅ | MFRC522 간섭 가능성 |
| **NFR-R01** 99% 성공 | ⚠️ | ✅ | ✅ | 클론 품질 편차 |
| | | | | |
| **총점** | 7/10 | **10/10** | 9/10 | |
| **가격** | $1-5 | $25-40 | $10-15 | |
| **권장 Stage** | 0 (학습) | **0-3 (프로덕션)** | 1 (대안) | |

### 5.2 결론

| 용도 | 권장 모듈 | 근거 |
|------|----------|------|
| **Stage 0 학습** | MFRC522 | 최저 비용, 최다 자료 |
| **Stage 0 검증** | MFRC522 + ST25R3911B 병행 | 프로덕션 스펙 검증 |
| **프로덕션 (최종)** | **ST25R3911B** | 모든 P0 + P1 충족 |
| **예비/대안** | PN532 정품 | ST25R3911B 공급 문제 시 |

---

## 6. Stage별 적용 계획

### 6.1 Stage 0: 학습 + 검증 병행

```
Phase 0-1: MFRC522로 기초 학습
     ↓
Phase 0-2: MFRC522로 E2E PoC 완성
     ↓
Phase 0-3: ST25R3911B 병행 테스트
     ↓
Phase 0-4: 프로덕션 스펙 충족 검증
     ↓
Stage 0 Gate: "ST25R3911B가 프로덕션 스펙 충족" 확인
```

### 6.2 Stage 1: 프로덕션 전환

```
- 모든 새 개발은 ST25R3911B 기준
- MFRC522 코드는 폐기 또는 레거시 호환용
- 다중 안테나 아키텍처 구현
```

### 6.3 하드웨어 BOM 업데이트

| 부품 | 수량 | 용도 | 구매 시점 |
|------|:----:|------|----------|
| MFRC522 | 2-3 | Stage 0 학습 | **즉시** |
| ST25R3911B | 1-2 | Stage 0 검증 | **즉시** |
| MIFARE 테스트 카드 | 10 | 테스트 | **즉시** |
| ST25R3911B | 6+ | Stage 1 프로덕션 | Stage 0 Gate 후 |

---

## 7. Stage 0 Gate 조건 업데이트

### 7.1 기존 조건

- [x] RFID 읽기 성공
- [x] E2E 지연 < 1초
- [x] 4시간 무중단
- [x] 팀 자신감

### 7.2 추가 조건 (신규)

- [ ] **프로덕션 모듈(ST25R3911B) 스펙 검증 완료**
- [ ] **본 문서(SPEC-RFID-Production-Module.md) P0 요구사항 PASS**
- [ ] TLS 통신 요구사항 결정 (Stage 1 적용 여부)
- [ ] 다중 안테나 아키텍처 설계 완료 (Stage 1용)

---

## 8. 검증 체크리스트

### 8.1 Stage 0 검증 (ST25R3911B)

| # | 테스트 항목 | 수용 기준 | 결과 |
|---|------------|----------|:----:|
| 1 | 13.56MHz 동작 | 데이터시트 확인 | ⬜ |
| 2 | MIFARE Classic 인식 | 테스트 카드 10회 | ⬜ |
| 3 | UID 정확성 | 10회 연속 일치 | ⬜ |
| 4 | 3cm 거리 인식 | 100회 100% | ⬜ |
| 5 | 5cm 거리 인식 | 100회 95%+ | ⬜ |
| 6 | 응답 시간 | <100ms | ⬜ |
| 7 | ESP32 SPI 연결 | 통신 성공 | ⬜ |
| 8 | 4시간 연속 운영 | 장애 0회 | ⬜ |
| 9 | E2E 지연 | <200ms | ⬜ |
| 10 | 인식 성공률 | 99%+ (1000회) | ⬜ |

### 8.2 검증 통과 기준

- **PASS**: 10/10 항목 충족
- **CONDITIONAL PASS**: 8-9/10 충족, 미충족 항목 문서화
- **FAIL**: 7/10 이하, 대안 모듈 검토

---

## 9. 관련 문서

| 문서 | 경로 | 역할 |
|------|------|------|
| RFID 모듈 결정 | `docs/decisions/DECISION-RFID-Module.md` | 모듈 선택 근거 |
| 부품 조달 계획 | `docs/procurement/PROCUREMENT-RFID-Parts.md` | BOM + 구매처 |
| 하드웨어 설계 | `docs/1-stage0/DESIGN-RFID-Hardware.md` | 배선도 |
| Stage 0 PRD | `docs/1-stage0/PRD-0003-Stage0-RFID-Connection.md` | Gate 조건 |

---

## 10. 승인

| 항목 | 담당 | 상태 | 날짜 |
|------|------|:----:|------|
| 초안 작성 | - | ✅ | 2026-01-30 |
| 기술 검토 | - | ⬜ | - |
| 팀 합의 | - | ⬜ | - |
| 최종 승인 | - | ⬜ | - |

---

**결론**:

> **EBS 프로덕션 RFID 모듈 = ST25R3911B (또는 동등 스펙 충족 모듈)**
>
> Stage 0에서 MFRC522 학습 후, **반드시 ST25R3911B로 프로덕션 스펙 검증**을 완료해야 Stage 0 Gate 통과 가능
