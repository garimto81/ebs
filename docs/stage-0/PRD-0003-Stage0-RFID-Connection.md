# PRD-0003-Stage0: RFID 연결 검증

**버전**: 1.0.1
**생성일**: 2026-01-28
**수정일**: 2026-01-29
**상위 문서**: [PRD-0003-EBS-RFID-System.md](PRD-0003-EBS-RFID-System.md)
**목표 기간**: 2026년 상반기 (H1)

---

## 1. Stage 0 개요

### 1.1 배경

> **"소프트웨어 전문 팀의 첫 하드웨어 도전"**

EBS 개발팀은 소프트웨어 전문 팀으로, RFID 하드웨어 작업은 처음입니다.
Stage 0는 본격적인 개발(Stage 1-3) 전에 하드웨어 연결 가능성을 검증하는 **기술 탐색 단계**입니다.

### 1.2 목표

| 목표 | 설명 |
|------|------|
| **하드웨어 학습** | ESP32 + MFRC522 기초 습득 |
| **연결 검증** | RFID → 서버 → 화면 파이프라인 증명 |
| **리스크 조기 발견** | 기술적 장벽 사전 파악 |
| **팀 역량 평가** | 하드웨어 작업 가능 여부 판단 |

### 1.3 핵심 원칙

| 원칙 | 설명 |
|------|------|
| **최소 범위** | 가장 단순한 형태로 증명 |
| **빠른 실패** | 문제 발견 시 조기 피봇 |
| **학습 우선** | 완성도보다 지식 습득 |
| **문서화** | 모든 시행착오 기록 |

### 1.4 기간

| 항목 | 일정 |
|------|------|
| 시작 | 2026년 2월 |
| 종료 | 2026년 6월 |
| 총 기간 | 5개월 (약 20주) |

---

## 2. 팀 역량 현황

### 2.1 보유 역량

| 역량 | 수준 | 비고 |
|------|------|------|
| Python/FastAPI | 상 | 백엔드 주력 |
| React/TypeScript | 상 | 프론트엔드 주력 |
| WebSocket | 중 | 실시간 통신 경험 |
| SQLite/PostgreSQL | 상 | DB 설계/운영 |

### 2.2 신규 학습 필요

| 기술 | 수준 | 학습 필요도 |
|------|------|------------|
| Arduino/C++ | 무 | **높음** |
| ESP32 | 무 | **높음** |
| RFID/NFC | 무 | **높음** |
| Serial 통신 | 저 | 중간 |
| 전자회로 기초 | 무 | 기초 |

### 2.3 학습 리소스

| 리소스 | URL | 용도 |
|--------|-----|------|
| ESP32 공식 문서 | espressif.com | 보드 학습 |
| Arduino 튜토리얼 | arduino.cc | 펌웨어 기초 |
| MFRC522 라이브러리 | GitHub | RFID 제어 |
| Random Nerd Tutorials | randomnerdtutorials.com | 실습 예제 |

---

## 3. 검증 범위 (Scope)

### 3.1 포함 (In Scope)

| 항목 | 설명 |
|------|------|
| 단일 RFID 리더 연결 | ESP32 + MFRC522 1개 |
| 카드 UID 읽기 | 기본 MIFARE 카드 |
| Serial 통신 | ESP32 → PC (USB) |
| 기본 서버 | Python으로 Serial 수신 |
| 단순 UI | 카드 UID 화면 표시 |

### 3.2 제외 (Out of Scope)

| 항목 | 사유 | Stage |
|------|------|-------|
| 카드-정보 매핑 | 복잡도 증가 | Stage 1 |
| 다중 리더 | 확장 기능 | Stage 1+ |
| 보안 기능 | 우선순위 낮음 | Stage 1 |
| 프로덕션 UI | 검증 불필요 | Stage 1 |
| OBS 연동 | 프로덕션 기능 | Stage 1 |

---

## 4. 기술 검증 목표

### 4.1 하드웨어 연결

```
[RFID 카드] → [MFRC522 리더] → [ESP32] → [USB Serial] → [PC]
```

**검증 포인트:**
- [ ] MFRC522가 ESP32와 SPI 통신
- [ ] ESP32가 카드 UID를 정상 읽기
- [ ] Serial로 PC에 데이터 전송
- [ ] 연결 안정성 (1시간 연속)

### 4.2 소프트웨어 파이프라인

```
[Serial] → [Python Server] → [WebSocket] → [React UI]
```

**검증 포인트:**
- [ ] pyserial로 Serial 수신
- [ ] FastAPI WebSocket 브로드캐스트
- [ ] React에서 실시간 표시
- [ ] 지연 시간 < 1초

### 4.3 End-to-End 검증

```
카드 스캔 → 화면에 UID 표시
```

**성공 기준:**
- 카드 스캔 후 1초 이내 화면 표시
- 10회 연속 스캔 성공 (오류 0회)
- 30분 연속 운영 가능

---

## 5. 하드웨어 구성

> 📖 **상세 하드웨어 설계**: [DESIGN-RFID-Hardware.md](DESIGN-RFID-Hardware.md)
> - MCU 대안 비교 (ESP32-C3, S3, C6, Pico W 등): Section 1.3
> - RFID 리더 대안 비교 (PN5180, PN532 등): Section 1.4

### 5.1 필요 부품

| 부품 | 수량 | 단가 (USD) | 용도 |
|------|------|------------|------|
| ESP32-WROOM-32 DevKit | 1 | $5 | 메인 컨트롤러 |
| MFRC522 모듈 | 1 | $2 | RFID 리더 |
| MIFARE Classic 1K 카드 | 5 | $0.50/장 | 테스트 카드 |
| 점퍼 와이어 (F-F) | 10 | $1 (세트) | 연결선 |
| 브레드보드 (옵션) | 1 | $3 | 프로토타입 |
| USB-C 케이블 | 1 | $2 | PC 연결 |

**총 비용**: 약 $15-20

### 5.2 배선도

```
ESP32          MFRC522
─────          ───────
3.3V    ────── VCC
GND     ────── GND
GPIO5   ────── SDA (SS)
GPIO18  ────── SCK
GPIO23  ────── MOSI
GPIO19  ────── MISO
GPIO4   ────── RST
        (IRQ 미사용)
```

### 5.3 주의사항

| 항목 | 주의 | 대응 |
|------|------|------|
| 전압 | MFRC522는 3.3V (5V 손상 가능) | ESP32 3.3V 사용 |
| 납땜 | 필요 없음 (점퍼 와이어) | 브레드보드 활용 |
| 정전기 | ESP32/MFRC522 민감 | 손목 접지 |

---

## 6. 개발 마일스톤

### Phase 0-1: 환경 설정 (2주)

| 작업 | 담당 | 완료 기준 |
|------|------|----------|
| 부품 구매 및 수령 | 전체 | 부품 도착 |
| Arduino IDE 설치 | 개발 | ESP32 인식 |
| ESP32 보드 설정 | 개발 | Blink 예제 동작 |
| MFRC522 라이브러리 | 개발 | 라이브러리 설치 |

### Phase 0-2: RFID 읽기 (4주)

| 작업 | 담당 | 완료 기준 |
|------|------|----------|
| 배선 연결 | 개발 | 배선 완료 |
| RFID 예제 실행 | 개발 | UID 시리얼 출력 |
| 카드 인식 테스트 | 개발 | 5장 모두 인식 |
| 안정성 테스트 | QA | 1시간 연속 성공 |

### Phase 0-3: Serial 통신 (4주)

| 작업 | 담당 | 완료 기준 |
|------|------|----------|
| JSON 포맷 설계 | 개발 | 포맷 확정 |
| ESP32 JSON 출력 | 개발 | Serial 출력 확인 |
| Python Serial 수신 | 개발 | 데이터 파싱 성공 |
| 에러 핸들링 | 개발 | 연결 끊김 복구 |

### Phase 0-4: UI 연동 (6주)

| 작업 | 담당 | 완료 기준 |
|------|------|----------|
| WebSocket 서버 | 백엔드 | 브로드캐스트 동작 |
| React 클라이언트 | 프론트 | UID 실시간 표시 |
| E2E 테스트 | QA | 카드→화면 <1초 |
| 문서화 | 전체 | 가이드 완성 |

### Phase 0-5: 안정화 (4주)

| 작업 | 담당 | 완료 기준 |
|------|------|----------|
| 연속 운영 테스트 | QA | 4시간 무중단 |
| 에러 로깅 | 개발 | 에러 추적 가능 |
| Stage 1 준비 | 전체 | Gate 조건 충족 |

---

## 7. 위험 요소 및 대응

### 7.1 기술 위험

| 위험 | 확률 | 영향 | 대응 |
|------|------|------|------|
| RFID 인식 불안정 | 중 | 고 | 안테나 조정, 다른 모듈 시도 |
| Serial 통신 끊김 | 중 | 중 | 자동 재연결 로직 |
| ESP32 학습 곡선 | 고 | 중 | 페어 프로그래밍, 외부 컨설팅 |

### 7.2 일정 위험

| 위험 | 확률 | 영향 | 대응 |
|------|------|------|------|
| 부품 배송 지연 | 저 | 저 | 국내 쇼핑몰 대안 |
| 학습 시간 초과 | 중 | 중 | 외부 튜토리얼 활용 |
| 예상치 못한 문제 | 중 | 고 | 4주 버퍼 (Phase 0-5) |

### 7.3 피봇 조건

다음 상황 발생 시 하드웨어 접근 방식 재검토:

| 상황 | 대안 |
|------|------|
| Phase 0-2 실패 (RFID 읽기) | 상용 USB RFID 리더 검토 |
| Phase 0-3 실패 (Serial 안정성) | 네트워크 기반 리더 검토 |
| 전체 실패 | 외주 하드웨어 개발 검토 |

---

## 8. 학습 산출물

### 8.1 문서

| 문서 | 내용 | 담당 |
|------|------|------|
| `docs/GUIDE-ESP32-Setup.md` | ESP32 환경 설정 가이드 | 개발 |
| `docs/GUIDE-RFID-Wiring.md` | 배선 및 연결 가이드 | 개발 |
| `docs/GUIDE-Serial-Protocol.md` | Serial 통신 프로토콜 | 개발 |
| `docs/TROUBLESHOOTING-Hardware.md` | 문제 해결 기록 | 전체 |

### 8.2 코드

| 코드 | 위치 | 설명 |
|------|------|------|
| ESP32 펌웨어 | `firmware/rfid_reader/` | 기본 RFID 읽기 |
| Python 서버 | `server/app/` | Serial + WebSocket |
| React UI | `frontend/src/` | UID 표시 |

---

## 9. Stage 0 Gate (전환 조건)

Stage 1 착수를 위해 다음 조건을 **모두** 충족해야 합니다:

| 조건 | 기준 | 검증 방법 |
|------|------|----------|
| RFID 읽기 | 5장 카드 100% 인식 | 테스트 로그 |
| E2E 지연 | 카드→화면 < 1초 | 타임스탬프 |
| 연속 운영 | 4시간 무중단 | 모니터링 |
| 팀 자신감 | "Stage 1 진행 가능" 합의 | 팀 회의록 |
| 문서화 | 4개 가이드 완성 | 문서 검토 |

**Gate 통과 시**: Stage 1 착수 (2026년 하반기)

---

## 10. Definition of Done

### 하드웨어

- [ ] ESP32 + MFRC522 연결 성공
- [ ] 5장 MIFARE 카드 인식
- [ ] 1시간 연속 운영 안정

### 소프트웨어

- [ ] Serial 수신 Python 서버
- [ ] WebSocket 브로드캐스트
- [ ] React UID 표시 UI

### 검증

- [ ] E2E 지연 < 1초
- [ ] 4시간 무중단 테스트
- [ ] 에러 로깅 동작

### 문서

- [ ] 환경 설정 가이드
- [ ] 배선 가이드
- [ ] 프로토콜 문서
- [ ] 트러블슈팅 기록

---

## 11. 문서 정보

| 항목 | 내용 |
|------|------|
| **문서 버전** | 1.0.0 |
| **작성일** | 2026-01-28 |
| **상태** | Draft |

